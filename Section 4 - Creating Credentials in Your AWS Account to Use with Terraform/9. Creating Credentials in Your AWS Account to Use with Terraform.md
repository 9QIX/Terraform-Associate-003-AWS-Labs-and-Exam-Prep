# AWS Credentials Setup for Terraform

## Overview

This lesson covers creating AWS IAM credentials and configuring environment variables to enable Terraform authentication with AWS services. The focus is on setting up minimal permissions for VPC-related resources to avoid costs during learning.

## Concepts

- **IAM User**: Dedicated service account for Terraform operations
- **Access Keys**: Programmatic credentials consisting of Access Key ID and Secret Access Key
- **Environment Variables**: Method to securely pass AWS credentials to Terraform
- **Least Privilege**: Using VPC-specific permissions instead of full administrator access

## AWS IAM Setup

### Creating the IAM User

1. Navigate to **IAM Console** in AWS Management Console
2. Select **Users** â†’ **Create User**
3. Set username (e.g., "Terraform")
4. Choose **Attach policies directly**
5. Search and select **AmazonVPCFullAccess** policy
6. Complete user creation

### Generating Access Keys

1. Click on the created user
2. Navigate to **Security Credentials** tab
3. Scroll to **Access Keys** section
4. Click **Create Access Key**
5. Select appropriate use case and acknowledge recommendations
6. Add optional description (e.g., "User creds for Terraform")
7. Save both Access Key ID and Secret Access Key

## Terraform Workflow

### Environment Variable Configuration

**macOS/Linux (Bash/Zsh):**

```bash
export AWS_ACCESS_KEY_ID=AKIA...
export AWS_SECRET_ACCESS_KEY=wJalrXUt...
export AWS_DEFAULT_REGION=us-east-1
```

**Line-by-line Comments:**

```bash
# Set AWS Access Key ID as environment variable
# Set AWS Secret Access Key as environment variable
# Set default AWS region for resource creation
```

**Windows (PowerShell):**

```powershell
$ENV:AWS_ACCESS_KEY_ID="AKIA..."
$ENV:AWS_SECRET_ACCESS_KEY="wJalrXUt..."
$ENV:AWS_DEFAULT_REGION="us-east-1"
```

**Line-by-line Comments:**

```powershell
# Set AWS Access Key ID using PowerShell environment variable syntax
# Set AWS Secret Access Key using PowerShell environment variable syntax
# Set default AWS region using PowerShell environment variable syntax
```

### Code Walkthrough

The environment variables provide Terraform with the necessary credentials to authenticate with AWS APIs. The `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY` are the programmatic credentials, while `AWS_DEFAULT_REGION` specifies the target region for resource deployment. These variables are automatically detected by the AWS provider in Terraform configurations.

## Providers & Resources

- **AWS Provider**: Automatically uses environment variables for authentication
- **VPC Resources**: Primary focus to minimize costs during learning
- **Resource Scope**: Limited to VPC components (subnets, route tables, internet gateways)

## State Management

- Credentials enable Terraform to read and modify AWS resources
- State file tracks resource ownership and current configuration
- Environment variables must be consistent across Terraform operations

## Pitfalls & Best Practices

### Security Considerations

- **Temporary Usage**: Delete access keys after course completion
- **Minimal Permissions**: Use VPC-specific policies instead of AdministratorAccess
- **Credential Rotation**: Regularly rotate access keys in production environments
- **Environment Isolation**: Use separate credentials for different environments

### Common Issues

- **Case Sensitivity**: Ensure proper capitalization in environment variable names
- **Terminal Sessions**: Environment variables are session-specific
- **Region Consistency**: Match region in credentials with Terraform configuration

## Key Terms & Definitions

- **IAM (Identity and Access Management)**: AWS service for managing users, groups, and permissions
- **Access Key**: Programmatic credential consisting of Access Key ID and Secret Access Key
- **Environment Variable**: System-level variable accessible to running processes
- **VPC (Virtual Private Cloud)**: Isolated network environment within AWS

## Common Exam Traps

- **Credential Storage**: Never hardcode credentials in Terraform files
- **Permission Scope**: Understanding difference between user-based and role-based access
- **Authentication Methods**: Environment variables vs. credential files vs. IAM roles
- **Security Best Practices**: Principle of least privilege and credential rotation

---

### Updated Information (as of 2024)

- **IAM Console Interface**: Updated to reflect current AWS console layout and navigation
- **Access Key Creation**: Process now includes additional security recommendations and warnings
- **PowerShell Syntax**: Confirmed compatibility with PowerShell 5.1+ and PowerShell Core
